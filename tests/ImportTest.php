<?php

use Illuminate\Foundation\Testing\WithoutMiddleware;
use Illuminate\Foundation\Testing\DatabaseMigrations;
use Illuminate\Foundation\Testing\DatabaseTransactions;

class ImportTest extends TestCase
{
    /**
     * A basic test example.
     *
     * @return void
     */
    public function testExample()
    {
    	$json = '{"_token":"HApRq6oML6qSKSC49U1dhfU0tKq3o4wPvEHxe0Vp","user_id":"9","new_dataset":"1","new_dataset_name":"fdsafdsafasd","new_dataset_description":"","existing_variable_id":"","multivariant_dataset":"0","variables":["{\"name\":\"fdsafdsafa\",\"values\":[{\"id\":0,\"key\":\"Iraq\",\"values\":[{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":69.757},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":60.0333}]},{\"id\":1,\"key\":\"Philippines\",\"values\":[{\"x\":{\"d\":\"1940-01-01\",\"l\":\"1940\",\"sd\":\"1940-01-01\",\"ed\":\"1941-01-01\",\"td\":\"year\"},\"y\":295.8},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":100.043},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":84.558},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":73.6333}]},{\"id\":2,\"key\":\"Lesotho\",\"values\":[{\"x\":{\"d\":\"1950-01-01\",\"l\":\"1950\",\"sd\":\"1950-01-01\",\"ed\":\"1951-01-01\",\"td\":\"year\"},\"y\":156},{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":130.9},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":116.554},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":95.959},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":93.427},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":88.2333}]},{\"id\":3,\"key\":\"Tanzania\",\"values\":[{\"x\":{\"d\":\"1950-01-01\",\"l\":\"1950\",\"sd\":\"1950-01-01\",\"ed\":\"1951-01-01\",\"td\":\"year\"},\"y\":155},{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":124},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":129.034},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":106.553},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":107.01}]},{\"id\":4,\"key\":\"Mali\",\"values\":[{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":201.23},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":181.77},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":150.568},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":132.108},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":121.667}]},{\"id\":5,\"key\":\"Sweden\",\"values\":[{\"x\":{\"d\":\"1830-01-01\",\"l\":\"1830\",\"sd\":\"1830-01-01\",\"ed\":\"1831-01-01\",\"td\":\"year\"},\"y\":173.9},{\"x\":{\"d\":\"1840-01-01\",\"l\":\"1840\",\"sd\":\"1840-01-01\",\"ed\":\"1841-01-01\",\"td\":\"year\"},\"y\":153.5},{\"x\":{\"d\":\"1850-01-01\",\"l\":\"1850\",\"sd\":\"1850-01-01\",\"ed\":\"1851-01-01\",\"td\":\"year\"},\"y\":148.9},{\"x\":{\"d\":\"1860-01-01\",\"l\":\"1860\",\"sd\":\"1860-01-01\",\"ed\":\"1861-01-01\",\"td\":\"year\"},\"y\":138.6},{\"x\":{\"d\":\"1870-01-01\",\"l\":\"1870\",\"sd\":\"1870-01-01\",\"ed\":\"1871-01-01\",\"td\":\"year\"},\"y\":131},{\"x\":{\"d\":\"1880-01-01\",\"l\":\"1880\",\"sd\":\"1880-01-01\",\"ed\":\"1881-01-01\",\"td\":\"year\"},\"y\":112.2},{\"x\":{\"d\":\"1890-01-01\",\"l\":\"1890\",\"sd\":\"1890-01-01\",\"ed\":\"1891-01-01\",\"td\":\"year\"},\"y\":102.2},{\"x\":{\"d\":\"1900-01-01\",\"l\":\"1900\",\"sd\":\"1900-01-01\",\"ed\":\"1901-01-01\",\"td\":\"year\"},\"y\":86.8},{\"x\":{\"d\":\"1910-01-01\",\"l\":\"1910\",\"sd\":\"1910-01-01\",\"ed\":\"1911-01-01\",\"td\":\"year\"},\"y\":70.7},{\"x\":{\"d\":\"1920-01-01\",\"l\":\"1920\",\"sd\":\"1920-01-01\",\"ed\":\"1921-01-01\",\"td\":\"year\"},\"y\":59.6},{\"x\":{\"d\":\"1930-01-01\",\"l\":\"1930\",\"sd\":\"1930-01-01\",\"ed\":\"1931-01-01\",\"td\":\"year\"},\"y\":47.7},{\"x\":{\"d\":\"1940-01-01\",\"l\":\"1940\",\"sd\":\"1940-01-01\",\"ed\":\"1941-01-01\",\"td\":\"year\"},\"y\":29.3},{\"x\":{\"d\":\"1950-01-01\",\"l\":\"1950\",\"sd\":\"1950-01-01\",\"ed\":\"1951-01-01\",\"td\":\"year\"},\"y\":18.6},{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":14.1},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":9.3},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":6.5}]}],\"unit\":\"\",\"description\":\"\"}"],"source_name":"fdsafdsafasd","source_description":"<br><div>\r\n</div>","_wysihtml5_mode":"1","category_id":"4","subcategory_id":"74","new_dataset_tags":"","variable_type":"3","data":"{\"variables\":[{\"name\":\"\",\"values\":[{\"id\":0,\"key\":\"Iraq\",\"values\":[{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":69.757},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":60.0333}]},{\"id\":1,\"key\":\"Philippines\",\"values\":[{\"x\":{\"d\":\"1940-01-01\",\"l\":\"1940\",\"sd\":\"1940-01-01\",\"ed\":\"1941-01-01\",\"td\":\"year\"},\"y\":295.8},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":100.043},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":84.558},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":73.6333}]},{\"id\":2,\"key\":\"Lesotho\",\"values\":[{\"x\":{\"d\":\"1950-01-01\",\"l\":\"1950\",\"sd\":\"1950-01-01\",\"ed\":\"1951-01-01\",\"td\":\"year\"},\"y\":156},{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":130.9},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":116.554},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":95.959},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":93.427},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":88.2333}]},{\"id\":3,\"key\":\"Tanzania\",\"values\":[{\"x\":{\"d\":\"1950-01-01\",\"l\":\"1950\",\"sd\":\"1950-01-01\",\"ed\":\"1951-01-01\",\"td\":\"year\"},\"y\":155},{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":124},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":129.034},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":106.553},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":107.01}]},{\"id\":4,\"key\":\"Mali\",\"values\":[{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":201.23},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":181.77},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":150.568},{\"x\":{\"d\":\"1990-01-01\",\"l\":\"1990\",\"sd\":\"1990-01-01\",\"ed\":\"1991-01-01\",\"td\":\"year\"},\"y\":132.108},{\"x\":{\"d\":\"2000-01-01\",\"l\":\"2000\",\"sd\":\"2000-01-01\",\"ed\":\"2001-01-01\",\"td\":\"year\"},\"y\":121.667}]},{\"id\":5,\"key\":\"Sweden\",\"values\":[{\"x\":{\"d\":\"1830-01-01\",\"l\":\"1830\",\"sd\":\"1830-01-01\",\"ed\":\"1831-01-01\",\"td\":\"year\"},\"y\":173.9},{\"x\":{\"d\":\"1840-01-01\",\"l\":\"1840\",\"sd\":\"1840-01-01\",\"ed\":\"1841-01-01\",\"td\":\"year\"},\"y\":153.5},{\"x\":{\"d\":\"1850-01-01\",\"l\":\"1850\",\"sd\":\"1850-01-01\",\"ed\":\"1851-01-01\",\"td\":\"year\"},\"y\":148.9},{\"x\":{\"d\":\"1860-01-01\",\"l\":\"1860\",\"sd\":\"1860-01-01\",\"ed\":\"1861-01-01\",\"td\":\"year\"},\"y\":138.6},{\"x\":{\"d\":\"1870-01-01\",\"l\":\"1870\",\"sd\":\"1870-01-01\",\"ed\":\"1871-01-01\",\"td\":\"year\"},\"y\":131},{\"x\":{\"d\":\"1880-01-01\",\"l\":\"1880\",\"sd\":\"1880-01-01\",\"ed\":\"1881-01-01\",\"td\":\"year\"},\"y\":112.2},{\"x\":{\"d\":\"1890-01-01\",\"l\":\"1890\",\"sd\":\"1890-01-01\",\"ed\":\"1891-01-01\",\"td\":\"year\"},\"y\":102.2},{\"x\":{\"d\":\"1900-01-01\",\"l\":\"1900\",\"sd\":\"1900-01-01\",\"ed\":\"1901-01-01\",\"td\":\"year\"},\"y\":86.8},{\"x\":{\"d\":\"1910-01-01\",\"l\":\"1910\",\"sd\":\"1910-01-01\",\"ed\":\"1911-01-01\",\"td\":\"year\"},\"y\":70.7},{\"x\":{\"d\":\"1920-01-01\",\"l\":\"1920\",\"sd\":\"1920-01-01\",\"ed\":\"1921-01-01\",\"td\":\"year\"},\"y\":59.6},{\"x\":{\"d\":\"1930-01-01\",\"l\":\"1930\",\"sd\":\"1930-01-01\",\"ed\":\"1931-01-01\",\"td\":\"year\"},\"y\":47.7},{\"x\":{\"d\":\"1940-01-01\",\"l\":\"1940\",\"sd\":\"1940-01-01\",\"ed\":\"1941-01-01\",\"td\":\"year\"},\"y\":29.3},{\"x\":{\"d\":\"1950-01-01\",\"l\":\"1950\",\"sd\":\"1950-01-01\",\"ed\":\"1951-01-01\",\"td\":\"year\"},\"y\":18.6},{\"x\":{\"d\":\"1960-01-01\",\"l\":\"1960\",\"sd\":\"1960-01-01\",\"ed\":\"1961-01-01\",\"td\":\"year\"},\"y\":14.1},{\"x\":{\"d\":\"1970-01-01\",\"l\":\"1970\",\"sd\":\"1970-01-01\",\"ed\":\"1971-01-01\",\"td\":\"year\"},\"y\":9.3},{\"x\":{\"d\":\"1980-01-01\",\"l\":\"1980\",\"sd\":\"1980-01-01\",\"ed\":\"1981-01-01\",\"td\":\"year\"},\"y\":6.5}]}]}]}"}';

    	$formData = json_decode($json, true);

        $user = factory(App\User::class)->create();

        $this->actingAs($user)
    		 ->post('/import/variables', $formData)
    		 ->dump()
    		 ->seeJson([
    		 	'created' => true,
    		 ]);
    }
}
